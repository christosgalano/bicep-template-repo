requires:
  PSRule.Rules.Azure: ">=1.30.0"

include:
  module:
    - PSRule.Rules.Azure

output:
  culture:
    - "en-US"
  style: "GitHubActions"

input:
  pathIgnore:
    # Exclude bicepconfig.json
    - "bicepconfig.json"

    # Exclude module files
    - "bicep/modules/**/*.bicep"

    # Include test files for modules
    - "!bicep/modules/**/*.tests.bicep"

configuration:
  # Enable expansion of Azure Template files.
  AZURE_PARAMETER_FILE_EXPANSION: true

  # Check Azure Bicep CLI.
  AZURE_BICEP_CHECK_TOOL: true

  # Enable expansion of Azure Bicep files (done through bicep build)
  AZURE_BICEP_FILE_EXPANSION: true
  AZURE_BICEP_PARAMS_FILE_EXPANSION: true
rule:
  # Enable custom rules that don't exist in the baseline.
  includeLocal: true

  # Ignore the following rules for all resources
  exclude:
    # Template
    - Azure.Template.UseVariables
    - Azure.Template.UseDescriptions

    # Resource
    - Azure.Resource.UseTags

    # App Service
    - Azure.AppService.HTTP2
    - Azure.AppService.WebSecureFtp
    - Azure.AppService.ARRAffinity
    - Azure.AppService.ManagedIdentity
    - Azure.AppService.MinTLS
    - Azure.AppService.PlanInstanceCount
    - Azure.AppService.WebProbe
    - Azure.AppService.WebProbePath
